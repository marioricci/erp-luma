SELECT QuantitySold, GrossSales - (GrossSales * TrustFund/100) 'GrossSales', TotalDiscount - (TotalDiscount * TrustFund/100) 'TotalDiscount', TotalCharge - (TotalCharge * TrustFund/100) 'TotalCharge', DailySales - (DailySales * TrustFund/100) 'DailySales', VAT - (VAT * TrustFund/100) 'VAT', LocalTax - (LocalTax * TrustFund/100) 'LocalTax', TotalCharge - (TotalCharge * TrustFund/100) AS 'ServiceCharge', DateLastInitialized, DATE_FORMAT(IF(HOUR(DateLastInitialized)>(SELECT SUBSTR(EndCutOffTime,1,2) FROM tblTerminal WHERE BranchID = @BranchID AND TerminalNo = tblTerminalReportHistory.TerminalNo), DATE_ADD(DateLastInitialized, INTERVAL 1 DAY), DateLastInitialized), '%Y-%m-%d') AS DateLastInitializedToDisplay, TerminalNo 
FROM  tblTerminalReportHistory WHERE 1=1 AND DATE_FORMAT(DateLastInitialized, '%Y-%m-%d %H:%i') >= DATE_FORMAT('2013-01-15 23:59:00', '%Y-%m-%d %H:%i') AND DATE_FORMAT(DateLastInitialized, '%Y-%m-%d %H:%i') <= DATE_FORMAT('2013-02-15 23:59:00', '%Y-%m-%d %H:%i') ORDER BY TerminalNo, DateLastInitialized ;

SELECT QuantitySold, GrossSales - (GrossSales * TrustFund/100) 'GrossSales', TotalDiscount - (TotalDiscount * TrustFund/100) 'TotalDiscount', TotalCharge - (TotalCharge * TrustFund/100) 'TotalCharge', DailySales - (DailySales * TrustFund/100) 'DailySales', VAT - (VAT * TrustFund/100) 'VAT', LocalTax - (LocalTax * TrustFund/100) 'LocalTax', TotalCharge - (TotalCharge * TrustFund/100) AS 'ServiceCharge', DateLastInitialized, DATE_FORMAT(IF(HOUR(DateLastInitialized)>(SELECT SUBSTR(EndCutOffTime,1,2) FROM tblTerminal WHERE TerminalNo = tblTerminalReportHistory.TerminalNo), DATE_ADD(DateLastInitialized, INTERVAL 1 DAY), DateLastInitialized), '%Y-%m-%d') AS DateLastInitializedToDisplay, TerminalNo FROM  tblTerminalReportHistory WHERE 1=1;
