

/***
insert into tbltransactionitemsbackup(
TransactionItemsID,
TransactionID,
ProductID,
ProductCode,
BarCode,
Description,
ProductUnitID,
ProductUnitCode,
Quantity,
Price,
SellingPrice,
Discount,
ItemDiscount,
ItemDiscountType,
Amount,
VAT,
VatableAmount,
EVAT,
EVatableAmount,
LocalTax,
VariationsMatrixID,
MatrixDescription,
ProductGroup,
ProductSubGroup,
TransactionItemStatus,
DiscountCode,
DiscountRemarks,
ProductPackageID,
MatrixPackageID,
PackageQuantity,
PromoQuantity,
PromoValue,
PromoInPercent,
PromoType,
PromoApplied,
PurchasePrice,
PurchaseAmount,
IncludeInSubtotalDiscount,
OrderSlipPrinter,
OrderSlipPrinted,
PercentageCommision,
Commision,
PaxNo,
TransactionDiscount,
DataSource,
CreatedOn,
LastModified,
SyncID,
ZeroRatedVAT,
NonVATableAmount,
VATExempt,
NonEVATableAmount,
backupdate)
select TransactionItemsID,
TransactionID,
ProductID,
ProductCode,
BarCode,
Description,
ProductUnitID,
ProductUnitCode,
Quantity,
Price,
SellingPrice,
Discount,
ItemDiscount,
ItemDiscountType,
Amount,
VAT,
VatableAmount,
EVAT,
EVatableAmount,
LocalTax,
VariationsMatrixID,
MatrixDescription,
ProductGroup,
ProductSubGroup,
TransactionItemStatus,
DiscountCode,
DiscountRemarks,
ProductPackageID,
MatrixPackageID,
PackageQuantity,
PromoQuantity,
PromoValue,
PromoInPercent,
PromoType,
PromoApplied,
PurchasePrice,
PurchaseAmount,
IncludeInSubtotalDiscount,
OrderSlipPrinter,
OrderSlipPrinted,
PercentageCommision,
Commision,
PaxNo,
TransactionDiscount,
DataSource,
CreatedOn,
LastModified,
SyncID,
ZeroRatedVAT,
NonVATableAmount,
VATExempt,
NonEVATableAmount,
now()
from tbltransactionitems where transactionid not in (select distinct transactionid from tbltransactions);


/**
insert into tbltransactionsbackup(
TransactionID,
TransactionNo,
CustomerID,
CustomerName,
CashierID,
CashierName,
TerminalNo,
TransactionDate,
DateSuspended,
DateResumed,
TransactionStatus,
SubTotal,
Discount,
TransDiscount,
TransDiscountType,
VAT,
VatableAmount,
EVAT,
EVatableAmount,
LocalTax,
AmountPaid,
CashPayment,
ChequePayment,
CreditCardPayment,
CreditPayment,
BalanceAmount,
ChangeAmount,
DateClosed,
PaymentType,
DiscountCode,
DiscountRemarks,
DebitPayment,
ItemsDiscount,
Charge,
ChargeAmount,
ChargeCode,
ChargeRemarks,
WaiterID,
WaiterName,
Packed,
OrderType,
AgentID,
AgentName,
CreatedByID,
CreatedByName,
AgentDepartmentName,
AgentPositionName,
ReleaserID,
ReleaserName,
ReleasedDate,
RewardPointsPayment,
RewardConvertedPayment,
PaxNo,
CreditChargeAmount,
BranchID,
BranchCode,
TransactionType,
isConsignment,
DataSource,
CustomerGroupName,
CreatedOn,
LastModified,
ORNo,
SyncID,
ZeroRatedVAT,
NonVATableAmount,
VATExempt,
NonEVATableAmount,
SNRDiscount,
PWDDiscount,
OtherDiscount,
NetSales,
ChargeType,
backupdate)
select TransactionID,
TransactionNo,
CustomerID,
CustomerName,
CashierID,
CashierName,
TerminalNo,
TransactionDate,
DateSuspended,
DateResumed,
TransactionStatus,
SubTotal,
Discount,
TransDiscount,
TransDiscountType,
VAT,
VatableAmount,
EVAT,
EVatableAmount,
LocalTax,
AmountPaid,
CashPayment,
ChequePayment,
CreditCardPayment,
CreditPayment,
BalanceAmount,
ChangeAmount,
DateClosed,
PaymentType,
DiscountCode,
DiscountRemarks,
DebitPayment,
ItemsDiscount,
Charge,
ChargeAmount,
ChargeCode,
ChargeRemarks,
WaiterID,
WaiterName,
Packed,
OrderType,
AgentID,
AgentName,
CreatedByID,
CreatedByName,
AgentDepartmentName,
AgentPositionName,
ReleaserID,
ReleaserName,
ReleasedDate,
RewardPointsPayment,
RewardConvertedPayment,
PaxNo,
CreditChargeAmount,
BranchID,
BranchCode,
TransactionType,
isConsignment,
DataSource,
CustomerGroupName,
CreatedOn,
LastModified,
ORNo,
SyncID,
ZeroRatedVAT,
NonVATableAmount,
VATExempt,
NonEVATableAmount,
SNRDiscount,
PWDDiscount,
OtherDiscount,
NetSales,
ChargeType,
now()
from tbltransactions where transactiondate <= '2013-12-12 23:59:59' and creditpayment = 0;

-- delete from tbltransactions where transactiondate <= '2013-12-12 23:59:59' and creditpayment = 0;



insert into tbltransactionitems(
TransactionItemsID,
TransactionID,
ProductID,
ProductCode,
BarCode,
Description,
ProductUnitID,
ProductUnitCode,
Quantity,
Price,
SellingPrice,
Discount,
ItemDiscount,
ItemDiscountType,
Amount,
VAT,
VatableAmount,
EVAT,
EVatableAmount,
LocalTax,
VariationsMatrixID,
MatrixDescription,
ProductGroup,
ProductSubGroup,
TransactionItemStatus,
DiscountCode,
DiscountRemarks,
ProductPackageID,
MatrixPackageID,
PackageQuantity,
PromoQuantity,
PromoValue,
PromoInPercent,
PromoType,
PromoApplied,
PurchasePrice,
PurchaseAmount,
IncludeInSubtotalDiscount,
OrderSlipPrinter,
OrderSlipPrinted,
PercentageCommision,
Commision,
PaxNo,
TransactionDiscount,
DataSource,
CreatedOn,
LastModified,
SyncID,
ZeroRatedVAT,
NonVATableAmount,
VATExempt,
NonEVATableAmount)
select TransactionItemsID,
TransactionID,
ProductID,
ProductCode,
BarCode,
Description,
ProductUnitID,
ProductUnitCode,
Quantity,
Price,
SellingPrice,
Discount,
ItemDiscount,
ItemDiscountType,
Amount,
VAT,
VatableAmount,
EVAT,
EVatableAmount,
LocalTax,
VariationsMatrixID,
MatrixDescription,
ProductGroup,
ProductSubGroup,
TransactionItemStatus,
DiscountCode,
DiscountRemarks,
ProductPackageID,
MatrixPackageID,
PackageQuantity,
PromoQuantity,
PromoValue,
PromoInPercent,
PromoType,
PromoApplied,
PurchasePrice,
PurchaseAmount,
IncludeInSubtotalDiscount,
OrderSlipPrinter,
OrderSlipPrinted,
PercentageCommision,
Commision,
PaxNo,
TransactionDiscount,
DataSource,
CreatedOn,
LastModified,
SyncID,
ZeroRatedVAT,
NonVATableAmount,
VATExempt,
NonEVATableAmount
from tbltransactionitemsbackup 
where transactionid in (select distinct transactionid from tbltransactions where transactiondate <= '2013-12-12 23:59' and creditpayment <>0)
and transactionitemsid not in (select distinct transactionitemsid from tbltransactionitems);
